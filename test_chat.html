<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>CHAT TESTING</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>

<body>
  <form action="">
    <fieldset>
			<legend>Send a chat message</legend>
			<label>Chat room name: <input type="text" id="room"></label>
			<label>Username: <input type="text" id="username"></label>
			<label>Message: <input type="text" id="message"></label>
			<input type="submit" id="submit" value="Send">
		</fieldset>
  </form>
  
  <ul id="messageList"></ul>

  <script src="/socket.io/socket.io.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
  <script>
    $(function () {
      
      $(document).ready(function(){
        $('#submit').attr('disabled',true);
        $('#message').keyup(function(){
          if($(this).val().length !=0 && $('#room').val().length !=0)
            $('#submit').attr('disabled', false);            
          else
            $('#submit').attr('disabled',true);
        })
      });
          
      var socket = io();
      $('form').submit(function(){
        socket.emit('message', {  room: $('#room').val(),
                                  username: $('#username').val(),
                                  message: $('#message').val()
                                }
        );
        $('#message').val('');
        $('#submit').attr('disabled',true);
        $('#room').attr('disabled',true);
        return false;
      });
      socket.on('message', function(msg){
        $('#messageList').append($('<li>').text(msg));
      });
    });
  </script>
</body>
</html>
